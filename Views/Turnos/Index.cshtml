@model AgendaDelConsultorio.Models.ReservaTurno

@{
    ViewData["Title"] = "Reserva de Turnos";
}

<h1>@ViewData["Title"]</h1>

<form asp-action="ReservarTurno">
    @Html.HiddenFor(model => model.PacienteId);

<div class="paso" id="paso1">
    <h4>Paso 1: Formulario de contacto</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Apellido)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Apellido)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Nombre)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Nombre)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.FechaNacimiento)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.FechaNacimiento)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.TipoDocumento)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.TipoDocumento)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.NumeroDocumento)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.NumeroDocumento)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Calle)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Calle)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Altura)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Altura)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.CodigoPostal)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.CodigoPostal)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.CorreoElectronico)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.CorreoElectronico)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Telefono)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Telefono)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Localidad)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Localidad.Descripcion)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Provincia)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Provincia.Descripcion)
        </dd>
    </dl>
    <button onclick="siguientePaso('paso1', 'paso2');">Siguente</button>
</div>

<br />
<hr />
<br />

<div class="paso oculto" id="paso2">
    <h4>Paso 2: Selección de la Especialidad</h4>
    <dl class="row">
        <dt class="col-sm-2">
            <label asp-for="TipoEspecialidadId" class="control-label"></label>
        </dt>
        <dd class="col-sm-10">
        <select asp-for="TipoEspecialidadId" class="form-control" asp-items="ViewBag.SelectListTipoEspecialidades"></select>
        </dd>
        <dt class="col-sm-2">
            <label asp-for="EspecialidadId" class="control-label"></label>
        </dt>
        <dd class="col-sm-10">
            <select asp-for="EspecialidadId" class="form-control" asp-items="ViewBag.SelectListEspecialidades"></select>
        </dd>
    </dl>

    <div class="form-group">
        <label asp-for="Observacion" class="control-label"></label>
        <input asp-for="Observacion" class="form-control" />
        <span asp-validation-for="Observacion" class="text-danger"></span>
    </div>
    <br />
    <button onclick="siguientePaso('paso2', 'paso3')">Siguiente</button>
    <button onclick="anteriorPaso('paso2', 'paso1')">Anterior</button>
</div>

<br />
<hr />
<br />

<div class="paso oculto" id="paso3">
    <h2>Paso 3: Selección de Fecha y Hora</h2>
    <dl class="row">
    <dt class="col-sm-2">
        <label asp-for="FechaTurno" class="control-label"></label>
    </dt>
    <dd class="col-sm-10">
        <select asp-for="FechaTurno" class="form-control">ViewBag.SelectListFechas</select>
    </dd>
    <dt class="col-sm-2">
        <label asp-for="HoraTurno" class="control-label"></label>
    </dt>
    <dd class="col-sm-10">
        <select asp-for="HoraTurno" class="form-control">ViewBag.SelectListHoras</select>
    </dd>
    </dl>

    <button onclick="siguientePaso('paso3', 'paso4')">Siguiente</button>
    <button onclick="anteriorPaso('paso3', 'paso2')">Anterior</button>
</div>


<br />
<hr />
<br />

<div class="paso oculto" id="paso4">
    <h2>Paso 4: Confirmación de los datos</h2>
    <hr />
    <h3>Datos de contacto:</h3>
    <dl class="row">
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Apellido)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Apellido)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.Nombre)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.Nombre)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.TipoDocumento)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.TipoDocumento)
        </dd>
        <dt class="col-sm-2">
            @Html.DisplayNameFor(model => model.Paciente.NumeroDocumento)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.NumeroDocumento)
        </dd>        
            @Html.DisplayNameFor(model => model.Paciente.CorreoElectronico)
        </dt>
        <dd class="col-sm-10">
            @Html.DisplayFor(model => model.Paciente.CorreoElectronico)
        </dd>       
    </dl>
    <hr />
    <h3>Datos de la Especialidad</h3>
    <dl class="row">
        <dt class="col-sm-2">
            <label asp-for="TipoEspecialidadId" class="control-label"></label>
        </dt>
        <dd class="col-sm-10">
            <select asp-for="TipoEspecialidadId" class="form-control" asp-items="ViewBag.SelectListTipoEspecialidades"></select>
        </dd>
        <dt class="col-sm-2">
            <label asp-for="EspecialidadId" class="control-label"></label>
        </dt>
        <dd class="col-sm-10">
            <select asp-for="EspecialidadId" class="form-control" asp-items="ViewBag.SelectListEspecialidades"></select>
        </dd>
    </dl>

    <div class="form-group">
        <label asp-for="Observacion" class="control-label"></label>
        <input asp-for="Observacion" class="form-control" readonly />        
    </div>

    <div class="form-group">
        <button type="submit" value="Reservar turno"></button>
    </div>

    <button onclick="anteriorPaso('paso4', 'paso3')">Anterior</button>
</div>

</form>













<script>
    function siguientePaso(pasoActual, pasoSiguiente {
        document.getElementById(pasoActual).classList.add('oculto');
    document.getElementById(pasoSiguiente).classList.remove('oculto');
             }

    function anteriorPaso(pasoActual, pasoAnterior) {
        document.getElementById(pasoActual).classList.add('oculto');
        document.getElementById(pasoAnterior).classList.remove('oculto')
    }

</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('#TipoEspecialidadId').change(function () {
            var tipoEspecialidadId = $(this).val();
            $.getJSON('/Turnos/ObtenerEspecialidadPorTipoEspecialidad', { tipoEspecialidadId: tipoEspecialidadId }, function (data) {
                var especialidadDropdown = $('#EspecialidadId');
                especialidadDropdown.empty();
                $.each(data, function (index, item) {
                    especialidadDropdown.append($('<option>', {
                        value: item.especialidadId,
                        text: item.descripcion
                    }));
                });
            });
        });
    });

    $(document).ready(function () {
        $('#FechaTurno').change(function () {
            var fechaSeleccionada = $(this).val();
            $.getJSON('/Turnos/ObtenerHorasLibresPorFecha', { fecha: fechaSeleccionada }, function (data) {
                var horasDropdown = $('#HoraTurno');
                horasDropdown.empty();
                $.each(data, function (index, item) {
                    horasDropdown.append($('<option>', {
                        value: hora,
                        text: hora
                    }));
                });
            });
        });
    });
</script>
